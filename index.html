<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Oauth2-client by tiabas</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Oauth2-client</h1>
        <h2>Make quick and dirty OAuth2 clients</h2>
        <a href="https://github.com/tiabas/oauth2-client" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>OAuth2 Ruby Client</h1>

<p><a href="https://rubygems.org/gems/oauth2-client"><img src="https://badge.fury.io/rb/oauth2-client.png" alt="Gem Version"></a>
<a href="http://travis-ci.org/tiabas/oauth2-client"><img src="https://secure.travis-ci.org/tiabas/oauth2-client.png?branch=master" alt="Build Status"></a></p>

<p>A Ruby wrapper for the OAuth 2.0 specification. It is designed with the philosophy that 
different service providers implement OAuth 2.0 differently and not exactly according to the
<a href="http://tools.ietf.org/html/rfc6749">RFC</a>. This gem therefore, affords 
the developer some degree of flexibility in creating a client that will work with many OAuth2
providers.</p>

<p>For more about the standard checkout: <a href="http://tools.ietf.org/html/rfc6749">http://tools.ietf.org/html/rfc6749</a> </p>

<h2>Installation</h2>

<div class="highlight"><pre>gem install oauth2-client
</pre></div>

<h2>Resources</h2>

<ul>
<li><a href="https://github.com/tiabas/oauth2-client">View Source on GitHub</a></li>
<li><a href="https://github.com/tiabas/oauth2-client/issues">Report Issues on GitHub</a></li>
</ul><h2>Usage Examples</h2>

<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'oauth2-client'</span>

<span class="vi">@client</span>  <span class="o">=</span> <span class="no">OAuth2</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">'https://example.com'</span><span class="p">,</span> <span class="s1">'s6BhdRkqt3'</span><span class="p">,</span> <span class="s1">'4hJZY88TCBB9q8IpkeualA2lZsUhOSclkkSKw3RXuE'</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">authorization_code</span><span class="o">.</span><span class="n">authorization_path</span><span class="p">(</span><span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth2/cb'</span><span class="p">)</span>
<span class="c1"># =&gt; "/oauth/authorize?response_type=code&amp;client_id={client_id}&amp;redirect_uri=http%3A%2F%2Flocalhost%2Foauth2%2Fcb"</span>

</pre></div>

<h2>Authorization Grants</h2>

<p>The client wraps around the creation of any given grant and passing in the parameters defined in the configuration
file. The supported grants include Authorization Code, Implicit, Resource Owner Password Credentials, Client Credentials.
There is also support for device authentication as described in Google's OAuth 2.0 authentication methods(<a href="https://developers.google.com/accounts/docs/OAuth2ForDevices">https://developers.google.com/accounts/docs/OAuth2ForDevices</a>). They are available via the #authorization_code, #implicit, #password, #client_credentials, #refresh_token
and #device methods on a client object.</p>

<p>The #get_token method on the grants does not make any assumptions about the format ofthe response from the OAuth provider. The ideal
case would be to treat all responses as JSON. However, some services may respond with in XML instead of JSON. The #get_token method
therefore, returns with an HTTPResponse object.</p>

<h3>Authorization Code</h3>

<div class="highlight"><pre><span class="n">auth_url</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorization_code</span><span class="o">.</span><span class="n">authorization_path</span><span class="p">(</span><span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth2/cb'</span><span class="p">)</span>
<span class="c1"># =&gt; "/oauth/authorize?response_type=code&amp;client_id={client_id}&amp;redirect_uri=http%3A%2F%2Flocalhost%2Foauth2%2Fcb"</span>

<span class="n">token_url</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorization_code</span><span class="o">.</span><span class="n">token_path</span><span class="p">(</span>
    <span class="ss">:code</span> <span class="o">=&gt;</span> <span class="n">aXW2c6bYz</span><span class="p">,</span> 
    <span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth2/cb'</span><span class="p">)</span>
<span class="c1"># =&gt; "/oauth/token?redirect_uri=http%3A%2F%2Flocalhost%2Foauth%2Fcb&amp;client_secret={client_secret}&amp;grant_type=authorization_code&amp;client_id={client_id}&amp;code=aXW2c6bYz"</span>
</pre></div>

<h3>Implicit Grant</h3>

<div class="highlight"><pre><span class="n">auth_url</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">implicit</span><span class="o">.</span><span class="n">authorization_path</span><span class="p">(</span><span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth2/cb'</span><span class="p">)</span>
<span class="c1"># =&gt; "oauth/?redirect_uri=http%3A%2F%2Flocalhost%2Foauth%2Fcb&amp;response_type=token&amp;client_id={client_id}"</span>
</pre></div>

<h3>Password Credentials</h3>

<div class="highlight"><pre><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s1">'username'</span><span class="p">,</span> <span class="s1">'password'</span><span class="p">)</span>
</pre></div>

<h3>Refresh Token</h3>

<div class="highlight"><pre><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">refresh_token</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">refresh_token_value</span><span class="p">,</span> <span class="ss">:params</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:scope</span> <span class="o">=&gt;</span> <span class="s1">'abc xyz'</span><span class="p">,</span> <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="s1">'state'</span><span class="p">})</span>
</pre></div>

<h3>Client Credentials</h3>

<div class="highlight"><pre><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">client_credentials</span><span class="o">.</span><span class="n">get_token</span>
</pre></div>

<h3>Device Code</h3>

<div class="highlight"><pre><span class="n">auth_url</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">device_code</span><span class="o">.</span><span class="n">authorization_path</span><span class="p">(</span><span class="ss">:scope</span> <span class="o">=&gt;</span> <span class="s1">'abc xyz'</span><span class="p">,</span> <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="s1">'state'</span><span class="p">)</span>
<span class="c1"># =&gt; "/oauth/device/code?scope=abc+xyz&amp;state=state&amp;client_id={client_id}"</span>

<span class="c1"># exchange device authorization code for access token</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">device_code</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">device_auth_code</span><span class="p">)</span>
</pre></div>

<h1>Client Examples</h1>

<p>This library comes bundled with two sample implementations of Google and Yammer OAuth clients. These clients are 
meant to showcase the degree of flexibilty that you get when using this library to interact with other OAuth 2.0
providers.</p>

<h2>Google Client</h2>

<div class="highlight"><pre>
<span class="n">google_client</span> <span class="o">=</span> <span class="no">GoogleClient</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="s1">'https://accounts.google.com'</span><span class="p">,</span>
  <span class="s1">'827502413694.apps.googleusercontent.com'</span><span class="p">,</span>
  <span class="s1">'a2nQpcUm2Dgq1chWdAvbXGTk'</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="ss">:token_path</span>     <span class="o">=&gt;</span> <span class="s1">'/o/oauth2/token'</span><span class="p">,</span>
    <span class="ss">:authorize_path</span> <span class="o">=&gt;</span> <span class="s1">'/o/oauth2/auth'</span><span class="p">,</span>
    <span class="ss">:device_path</span>    <span class="o">=&gt;</span> <span class="s1">'/o/oauth2/device/code'</span>
  <span class="p">}</span>
<span class="p">)</span>

</pre></div>

<h3>Client-side authorization URL(Implicit grant)</h3>

<div class="highlight"><pre><span class="n">auth_url</span> <span class="o">=</span> <span class="n">google_client</span><span class="o">.</span><span class="n">webserver_authorization_url</span><span class="p">(</span>
    <span class="ss">:scope</span> <span class="o">=&gt;</span> <span class="s1">'https://www.googleapis.com/auth/userinfo.email'</span><span class="p">,</span>
    <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="s1">'/profile'</span><span class="p">,</span>
    <span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'https://oauth2-login-demo.appspot.com/code'</span><span class="p">,</span>
    <span class="ss">:approval_prompt</span> <span class="o">=&gt;</span> <span class="s1">'force'</span><span class="p">)</span>
<span class="c1"># =&gt; https://accounts.google.com/o/oauth2/auth?scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&amp;state=%2Fprofile&amp;redirect_uri=https%3A%2F%2Foauth2-login-demo.appspot.com%2Ftoken&amp;approval_prompt=force&amp;response_type=token&amp;client_id=812741506391.apps.googleusercontent.com</span>
</pre></div>

<h3>Server-side authorization URL(Authorization code grant)</h3>

<div class="highlight"><pre><span class="n">auth_url</span> <span class="o">=</span> <span class="n">google_client</span><span class="o">.</span><span class="n">clientside_authorization_url</span><span class="p">(</span>
    <span class="ss">:scope</span> <span class="o">=&gt;</span> <span class="s1">'https://www.googleapis.com/auth/userinfo.email'</span><span class="p">,</span>
    <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="s1">'/profile'</span><span class="p">,</span>
    <span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth/code'</span><span class="p">,</span>
    <span class="ss">:approval_prompt</span> <span class="o">=&gt;</span> <span class="s1">'force'</span><span class="p">)</span>
<span class="c1"># =&gt; https://accounts.google.com/o/oauth2/auth?scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&amp;state=%2Fprofile&amp;redirect_uri=https%3A%2F%2Foauth2-login-demo.appspot.com%2Fcode&amp;approval_prompt=force&amp;response_type=code&amp;client_id=812741506391.apps.googleusercontent.com</span>

<span class="c1"># exchange authorization code for access token. we will get back a Net::HTTPResponse</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">google_client</span><span class="o">.</span><span class="n">exchange_auth_code_for_token</span><span class="p">(</span>
  <span class="ss">:params</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="ss">:code</span> <span class="o">=&gt;</span> <span class="s1">'4/dbB0-UD1cvrQg2EuEFtRtHwPEmvR.IrScsjgB5M4VuJJVnL49Cc8QdUjRdAI'</span><span class="p">,</span>
    <span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="s1">'http://localhost/oauth/token'</span>
  <span class="p">}</span>
<span class="p">)</span>
<span class="n">response</span><span class="o">.</span><span class="n">inspect</span> 
<span class="c1"># =&gt; #&lt;Net::HTTPOK:0x007ff8bc7c1200&gt;</span>

<span class="n">response</span><span class="o">.</span><span class="n">body</span>
<span class="c1"># =&gt; {</span>
  <span class="s2">"access_token"</span> <span class="p">:</span> <span class="s2">"ya91.AHES8ZS-oCZnc5yHepnsosFjNln9ZKLuioF6FcMRCGUIzA"</span><span class="p">,</span>
  <span class="s2">"token_type"</span> <span class="p">:</span> <span class="s2">"Bearer"</span><span class="p">,</span>
  <span class="s2">"expires_in"</span> <span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
  <span class="s2">"id_token"</span> <span class="p">:</span> <span class="s2">"eyJhbGciOiJSUzI1NiIsImtpZCI6IjY4ZGM2ZmIxNDQ5OGJmMWRhNjNiMWYyMDA2YmRmMDA2N2Q4MzY"</span><span class="p">,</span>
  <span class="s2">"refresh_token"</span> <span class="p">:</span> <span class="s2">"6/Ju8uhi9xOctGEyHRzWwHhaYimfxmY0tiJ_qW3qvjWXM"</span>
<span class="p">}</span>
</pre></div>

<h2>Supported Ruby Versions</h2>

<p>This library aims to support and is <a href="http://travis-ci.org/tiabas/oauth2-client">tested against</a> the following Ruby
version:</p>

<ul>
<li>Ruby 1.9.2</li>
<li>Ruby 1.9.3</li>
</ul><p>This library may inadvertently work (or seem to work) on other Ruby
implementations, however support will only be provided for the versions listed
above.</p>

<h2>Copyright</h2>

<p>Copyright (c) 2013 Kevin Mutyaba
See <a href="https://github.com/tiabas/oauth2-client/blob/master/LICENSE">LICENSE</a> for details.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/tiabas/oauth2-client/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/tiabas/oauth2-client/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/tiabas/oauth2-client"></a> is maintained by <a href="https://github.com/tiabas">tiabas</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>